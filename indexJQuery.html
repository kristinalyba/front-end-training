<!DOCTYPE html>
<html>
<head>
    <title>Yahoo news</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <script src="scripts/jquery-1.4.4.min.js" type="text/javascript"></script>
    <script src="scripts/jQuery.tmpl.min.js" type="text/javascript"></script>
    <style>
        h1 {
            color: #111;
            font-family: 'Open Sans Condensed', sans-serif;
            font-size: 64px;
            font-weight: 700;
            line-height: 64px;
            padding: 20px 30px;
            text-align: center;
            text-transform: uppercase;
        }

        a {
            color: #CCFFFF;
        }

        .news-post {
            width: 48%;
            height: 400px;
            margin: 5px 1%;
            position: relative;
            float: left;
            border-radius: 5px;
            background-size: cover;
        }

        .news-title {
            background: #FFFFFF;
            opacity: 0.7;
            font-weight: bold;
            font-size: 28px;
        }

        .news-description {
            display: none;
            color: #FFFFFF;
            text-shadow: 1px 1px 2px black;
            font-family: 'Open Sans', sans-serif;
            font-size: 24px;
        }

        @media (max-width: 1000px) {
            .news-post {
                width: 100%;
                margin-bottom: 10px;
                font-size: 24px;
            }

            .news-title {
                font-size: 30px;
            }
        }
    </style>
</head>
<body>
<div class="container">
    <div id="header" class="jumbotron"><h1>Meet the latest news from Yahoo!</h1></div>
    <div id="all-news" class="col-lg-12"></div>
</div>

<script>
    $(function(){
        $.get("newsPostTemplate.html", function(data){
            $.template("cachedNewsPostTemplate", data );
        });

        $.get("newsDescriptionTemplate.html", function(data){
            $.template("cachedNewsDescriptionTemplate", data );
        });

        getData("http://pipes.yahoo.com/pipes/pipe.run?_id=fe9a2e77dffb3205d035c4e311d77bbe6&_render=json", generateContent, handleError);

        $("#all-news").delegate(".news-post", "click", this, toggleDescription);
    });

    function getData(url, callback, errorHandler){
        $.ajax({
            type: 'GET',
            url: url,
            async: true,
            dataType: 'json',
            success: function(data){
                callback(data);
            },
            error: function(request, textStatus, message){
                errorHandler(textStatus);
            }
        });
    }

    function generateContent(data){
        $.tmpl("cachedNewsPostTemplate", data.value.items).appendTo("#all-news");
    }

    function handleError(textStatus) {
        $("#header").find("h1").text("Ooops...Something went wrong.");
        alert("Request aborted. Reason: " + textStatus);
    }

    function toggleDescription() {
        $(this).find(".news-description").slideToggle();
    }
</script>
</body>
</html>
